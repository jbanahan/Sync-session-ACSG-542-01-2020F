require 'open_chain/custom_handler/lumber_liquidators/lumber_custom_definition_helper'
class LL11282Report

  PRODUCTION_ORDERS = ["4500181626","4500181581","4500181584","4500181622","4500183957","4500182284","4500182285","4500174068","4500176822","4500176823","4500184749","4500187933","4500190338","4500190339","4500184812","4500181587","4500184751","4500184752","4500184122","4500184616","4500183731","4500183724","4500184092","4500184157","4500172050","4500182525","4500182526","4500182527","4500182529","4500182469","4500182470","4500182452","4500182453","4500182454","4500182455","4500178848","4500184272","4500178835","4500182410","4500187633","4500182362","4500182363","4500182297","4500176869","4500176837","4500184200","4500184201","4500184228","4500184229","4500182237","4500182238","4500182239","4500182240","4500182574","4500182576","4500187916","4500187905","4500187745","4500187728","4500188395","4500188396","4500188397","4500187596","4500186545","4500186549","4500182533","4500182534","4500182389","4500182378","4500182271","4500182241","4500182242","4500184773","4500184871","4500184515","4500184471","4500188398","4500188399","4500188400","4500184142","4500184143","4500182478","4500182464","4500187597","4500184219","4500182262","4500182263","4500184786","4500190424","4500184514","4500187746","4500184470","4500184084","4500190215","4500190216","4500190217","4500182500","4500182501","4500182502","4500182503","4500182504","4500182505","4500182506","4500182507","4500190069","4500190070","4500187698","4500187699","4500187700","4500176824","4500176825","4500190126","4500156510","4500156511","4500156512","4500156513","4500182260","4500182261","4500181585","4500181627","4500181562","4500181565","4500181615","4500181616","4500181590","4500184799","4500183150","4500183130","4500183110","4500184120","4500184630","4500187765","4500187766","4500187767","4500183070","4500183021","4500187738","4500187718","4500187719","4500184158","4500181625","4500181629","4500178834","4500171917","4500171920","4500181563","4500181567","4500181568","4500176838","4500184203","4500184230","4500161283","4500187944","4500190041","4500173935","4500176860","4500184785","4500184516","4500184517","4500184518","4500184472","4500184474","4500188418","4500190218","4500190852","4500190127","4500184788","4500187826","4500187827","4500190335","4500190336","4500190337","4500187697","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500180169","4500187945","4500187924","4500184796","4500184709","4500187836","4500187773","4500187774","4500187739","4500184094","4500190322","4500190231","4500173923","4500173925","4500190129","4500184231","4500184232","4500184787","4500188316","4500188317","4500188318","4500182399","4500182339","4500182287","4500187917","4500184775","4500187903","4500187904","4500184885","4500184761","4500184658","4500190341","4500190344","4500187730","4500190325","4500187715","4500190219","4500190169","4500182264","4500182564","4500190459","4500184758","4500184759","4500184739","4500184740","4500184741","4500184657","4500184621","4500184622","4500184572","4500184573","4500190358","4500190359","4500184559","4500184560","4500184525","4500184526","4500184527","4500190340","4500187729","4500184475","4500184087","4500188404","4500188427","4500184144","4500184145","4500173986","4500173987","4500190195","4500190196","4500184266","4500190143","4500182385","4500182373","4500182374","4500190827","4500176826","4500176827","4500184220","4500182227","4500182228","4500182229","4500187491","4500187492","4500187934","4500184771","4500184678","4500187837","4500187805","4500187750","4500187751","4500182508","4500182509","4500187521","4500187522","4500190071","4500183485","4500182570","4500186554","4500187943","4500184815","4500184769","4500184770","4500184753","4500187835","4500184615","4500187791","4500184546","4500184547","4500184548","4500184553","4500187756","4500184490","4500187720","4500188413","4500190314","4500172051","4500182535","4500182536","4500182481","4500182434","4500182435","4500188358","4500188359","4500184250","4500184251","4500184252","4500184253","4500188295","4500188296","4500188297","4500182424","4500182425","4500182409","4500182412","4500182390","4500182379","4500182298","4500176871","4500182272","4500182243","4500182244","4500183457","4500183363","4500183364","4500182927","4500182930","4500182883","4500182835","4500184631","4500184554","4500184499","4500184500","4500184491","4500182273","4500186546","4500186548","4500184818","4500184820","4500184776","4500184876","4500184887","4500185008","4500192779","4500191428","4500191429","4500191430","4500191392","4500191393","4500191394","4500188428","4500187520","4500182441","4500182419","4500190044","4500182341","4500182342","4500182344","4500182345","4500182346","4500190829","4500183102","4500191456","4500191457","4500191458","4500191459","4500182903","4500182909","4500182856","4500182823","4500182727","4500182651","4500182652","4500182653","4500182654","4500184519","4500184520","4500184521","4500184528","4500184529","4500184530","4500184476","4500184477","4500184085","4500184088","4500184147","4500184148","4500190035","4500173918","4500176828","4500184221","4500183103","4500184113","4500183053","4500183005","4500190283","4500190284","4500190242","4500190243","4500190244","4500191000","4500190199","4500190867","4500190868","4500190869","4500184175","4500190360","4500183051","4500191425","4500191426","4500191427","4500191390","4500191391","4500184086","4500173988","4500173989","4500187513","4500187514","4500187515","4500190060","4500184267","4500184268","4500188283","4500188284","4500190045","4500182400","4500190037","4500182290","4500182291","4500175482","4500175472","4500184222","4500182566","4500183131","4500183111","4500183071","4500183022","4500183152","4500183072","4500184160","4500184206","4500184207","4500184208","4500183132","4500183112","4500183023","4500188414","4500188417","4500184234","4500187911","4500184754","4500184665","4500188378","4500183151","4500184125","4500187816","4500190365","4500182708","4500182709","4500182710","4500187770","4500187775","4500187776","4500191422","4500191423","4500191424","4500184093","4500188416","4500190323","4500190264","4500184159","4500172052","4500182537","4500182539","4500184254","4500184255","4500188344","4500178840","4500190874","4500187635","4500176886","4500182380","4500173927","4500184204","4500184205","4500184233","4500182245","4500182246","4500177067","4500184839","4500184840","4500190187","4500182572","4500183153","4500183133","4500183113","4500187768","4500187769","4500187758","4500183073","4500183024","4500187740","4500187721","4500188345","4500186550","4500187946","4500187925","4500187912","4500184988","4500185011","4500184836","4500184837","4500184800","4500184126","4500187817","4500184591","4500190366","4500184549","4500184550","4500184551","4500187777","4500187778","4500187779","4500187757","4500187759","4500191412","4500191413","4500190327","4500190328","4500184492","4500187722","4500188438","4500190265","4500184169","4500182540","4500182541","4500190945","4500190946","4500184256","4500184257","4500188346","4500188347","4500184273","4500188299","4500178841","4500184276","4500184277","4500188615","4500190875","4500182381","4500184187","4500182274","4500182247","4500182248","4500190445","4500190422","4500190399","4500190400","4500190211","4500190188","4500179916","4500179917","4500184842","4500184843","4500187849","4500191267","4500181575","4500183683","4500192340","4500192331","4500188305","4500181564","4500181569","4500181570","4500183677","4500183678","4500187913","4500184819","4500184822","4500184989","4500185014","4500184801","4500184666","4500184646","4500184647","4500184127","4500190367","4500184565","4500184566","4500184552","4500187771","4500187772","4500191414","4500191415","4500184493","4500188415","4500188439","4500190267","4500182542","4500187537","4500190194","4500188300","4500188301","4500184210","4500184211","4500184235","4500190785","4500183785","4500183733","4500183679","4500190446","4500190401","4500190402","4500190403","4500190189","4500179918","4500179919","4500179920","4500182472","4500181619","4500183967","4500183122","4500183052","4500183004","4500182482","4500187519","4500190064","4500190065","4500190059","4500182397","4500190036","4500183966","4500187947","4500187926","4500184803","4500179913","4500183261","4500184825","4500191259","4500184990","4500185010","4500184845","4500184846","4500184802","4500184742","4500184743","4500184714","4500184715","4500191226","4500192680","4500192659","4500187818","4500184605","4500187793","4500184580","4500184581","4500191055","4500187747","4500187752","4500187753","4500183074","4500183025","4500190329","4500184494","4500187723","4500188405","4500190318","4500190319","4500190320","4500188419","4500190268","4500190220","4500182510","4500182511","4500187523","4500187524","4500190072","4500187701","4500188360","4500190877","4500184281","4500190052","4500176888","4500187507","4500187620","4500184212","4500184213","4500187599","4500190797","4500184236","4500182230","4500187493","4500179915","4500183365","4500183262","4500183684","4500183786","4500190411","4500183727","4500190171","4500183680","4500183969","4500183576","4500183577","4500183578","4500183429","4500184823","4500190447","4500190448","4500190404","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500190976","4500179914","4500183458","4500183263","4500183264","4500184821","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500187546","4500188241","4500188242","4500183579","4500183580","4500183581","4500183430","4500183431","4500183432","4500183433","4500183434","4500183435","4500183436","4500183437","4500183438","4500190343","4500187598","4500183681","4500190345","4500190346","4500187731","4500190490","4500187702","4500190853","4500187935","4500187948","4500187918","4500187927","4500184777","4500184807","4500183499","4500183360","4500183305","4500183306","4500183249","4500183250","4500184992","4500184996","4500185009","4500184998","4500184999","4500194376","4500194377","4500184824","4500184826","4500184847","4500184848","4500184792","4500184794","4500184804","4500184805","4500184772","4500184774","4500184684","4500184687","4500184688","4500184717","4500184718","4500184659","4500184667","4500187838","4500187839","4500187846","4500190430","4500190431","4500183143","4500183154","4500183123","4500183124","4500183134","4500183114","4500184114","4500184623","4500184624","4500184617","4500184602","4500190412","4500187794","4500190371","4500190372","4500190373","4500184574","4500184575","4500184582","4500184583","4500190361","4500184561","4500184567","4500184568","4500191047","4500184522","4500184523","4500184524","4500190347","4500190348","4500187748","4500183054","4500183075","4500183007","4500191398","4500187732","4500190330","4500184478","4500187716","4500188401","4500188429","4500190285","4500190286","4500191015","4500190245","4500190246","4500190247","4500190269","4500191001","4500184162","4500190221","4500190222","4500190223","4500173990","4500173991","4500184171","4500182512","4500182513","4500187525","4500187526","4500190073","4500184452","4500184455","4500187704","4500191910","4500184261","4500188321","4500188322","4500188323","4500188324","4500190172","4500188604","4500188605","4500190857","4500192967","4500182426","4500182413","4500190042","4500187631","4500182375","4500175483","4500175484","4500184189","4500190830","4500190841","4500187600","4500187601","4500184237","4500182265","4500182231","4500187494","4500187906","4500187901","4500191254","4500183790","4500183787","4500183963","4500187893","4500184789","4500184790","4500190432","4500190420","4500190421","4500187799","4500183908","4500190375","4500184531","4500184532","4500184533","4500187754","4500188406","4500188407","4500190200","4500161258","4500190173","4500190174","4500176890","4500183439","4500183440","4500183441","4500183442","4500183443","4500183444","4500190423","4500190405","4500190406","4500192982","4500192983","4500190213","4500183144","4500183104","4500183055","4500183008","4500188243","4500183582","4500183583","4500183584","4500183585","4500183459","4500183460","4500183366","4500183367","4500183445","4500183446","4500183296","4500184827","4500184828","4500184562","4500183954","4500183964","4500192341","4500183959","4500183672","4500183673","4500187936","4500187949","4500187919","4500193133","4500184808","4500190458","4500183588","4500183589","4500183500","4500183447","4500183448","4500183361","4500183307","4500183308","4500183251","4500183252","4500184879","4500184994","4500185012","4500184997","4500185000","4500185001","4500194378","4500194379","4500184849","4500184850","4500184806","4500184719","4500184720","4500184669","4500187840","4500187847","4500184115","4500193011","4500193012","4500187800","4500187784","4500184584","4500184569","4500191048","4500184534","4500184535","4500184536","4500190350","4500190351","4500190352","4500190353","4500187749","4500187755","4500183076","4500191437","4500191438","4500191439","4500183027","4500191401","4500191402","4500191420","4500191421","4500187733","4500187742","4500184479","4500187717","4500188402","4500188403","4500188408","4500188409","4500188430","4500188441","4500188442","4500191016","4500190248","4500190249","4500190250","4500190270","4500191002","4500184149","4500184150","4500184163","4500190986","4500173992","4500182514","4500182515","4500182544","4500187527","4500187528","4500187542","4500190074","4500184453","4500184457","4500184458","4500187705","4500188325","4500188326","4500184269","4500184275","4500188286","4500178842","4500184278","4500184279","4500188619","4500190166","4500190167","4500184282","4500190854","4500190053","4500182414","4500184176","4500187508","4500188246","4500188247","4500190831","4500187615","4500187622","4500184192","4500187602","4500187603","4500184223","4500184238","4500182232","4500187495","4500183956","4500184711","4500184713","4500190433","4500190434","4500193020","4500193021","4500190417","4500190376","4500190377","4500190378","4500190379","4500184501","4500184502","4500190333","4500187741","4500190232","4500190201","4500184258","4500184259","4500188348","4500188349","4500190175","4500190176","4500190177","4500190876","4500173958","4500184188","4500183501","4500183586","4500183587","4500183461","4500183368","4500190449","4500190450","4500183369","4500183370","4500183329","4500191171","4500191173","4500191174","4500191175","4500191176","4500191178","4500191179","4500188244","4500190139","4500190374","4500190132","4500190133","4500183502","4500183503","4500183462","4500183463","4500183464","4500183465","4500183466","4500183324","4500183328","4500183265","4500183266","4500188290","4500188291","4500181618","4500187937","4500187938","4500187920","4500184778","4500184779","4500183535","4500183536","4500183537","4500183538","4500183539","4500183477","4500183478","4500183383","4500183339","4500183340","4500183347","4500183280","4500183281","4500183208","4500183209","4500183210","4500183211","4500184882","4500187902","4500191255","4500185015","4500185016","4500187894","4500187895","4500194381","4500194382","4500184795","4500184797","4500184762","4500184745","4500184689","4500184690","4500184660","4500188376","4500184625","4500184626","4500193013","4500184614","4500187785","4500187786","4500184576","4500184577","4500184563","4500184564","4500190354","4500191440","4500191441","4500191442","4500191443","4500191403","4500191405","4500191406","4500187734","4500184480","4500184481","4500188420","4500188431","4500188432","4500188443","4500190287","4500190288","4500190251","4500190252","4500190253","4500191003","4500184151","4500184161","4500190224","4500190225","4500184166","4500184170","4500182516","4500182517","4500187529","4500187530","4500190075","4500184454","4500187706","4500191896","4500191897","4500184243","4500184244","4500184260","4500188327","4500188328","4500188350","4500188351","4500184270","4500188287","4500188288","4500188606","4500188607","4500188616","4500188617","4500190147","4500190859","4500188251","4500182386","4500182376","4500188248","4500188249","4500190832","4500190839","4500190840","4500187616","4500184193","4500187604","4500187606","4500184224","4500184225","4500182266","4500182233","4500187497","4500183174","4500183175","4500183176","4500183682","4500183781","4500190435","4500183910","4500190203","4500182543","4500187538","4500190178","4500190180","4500182365","4500183674","4500183504","4500183513","4500183514","4500183515","4500183516","4500183517","4500183518","4500183332","4500183334","4500183267","4500183268","4500183269","4500183173","4500192320","4500190451","4500183671","4500183540","4500183541","4500183542","4500183384","4500183385","4500183386","4500183387","4500183388","4500183389","4500183390","4500183391","4500183392","4500183393","4500183394","4500183395","4500183396","4500183397","4500183398","4500193180","4500193180","4500193180","4500193180","4500193180","4500193180","4500188245","4500190819","4500193180","4500193180","4500193180","4500183519","4500183371","4500183179","4500183180","4500183961","4500194368","4500194370","4500191180","4500191181","4500191182","4500191184","4500192251","4500191264","4500190811","4500190813","4500183505","4500183506","4500183467","4500183471","4500183472","4500183473","4500183474","4500183335","4500183336","4500183337","4500183270","4500183271","4500183562","4500183563","4500183564","4500183565","4500183566","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500185582","4500187939","4500187921","4500184781","4500187907","4500183479","4500183480","4500183399","4500183400","4500183401","4500183402","4500183403","4500183405","4500183406","4500183407","4500183408","4500183409","4500183412","4500183413","4500183414","4500183341","4500183342","4500183348","4500183349","4500183350","4500183351","4500183352","4500183282","4500183283","4500183293","4500183212","4500183213","4500183214","4500183215","4500187897","4500187898","4500184830","4500184831","4500187850","4500187851","4500184747","4500184748","4500184691","4500184692","4500184661","4500187841","4500183145","4500183125","4500191465","4500183105","4500191462","4500187828","4500187829","4500193014","4500187807","4500187808","4500190362","4500190363","4500191049","4500190355","4500183056","4500183057","4500191444","4500191445","4500191446","4500183009","4500183010","4500191407","4500191408","4500187735","4500188421","4500188433","4500188444","4500188445","4500190254","4500190255","4500190256","4500191004","4500184152","4500184153","4500190226","4500184167","4500182518","4500182519","4500187531","4500187532","4500190076","4500182465","4500182432","4500187707","4500187708","4500191898","4500191899","4500184245","4500184247","4500188329","4500184271","4500188289","4500188608","4500188609","4500188252","4500190046","4500190047","4500190038","4500187509","4500187511","4500187623","4500187624","4500190833","4500187617","4500184194","4500187607","4500187608","4500190780","4500182267","4500182234","4500187498","4500187499","4500183955","4500183952","4500183962","4500190436","4500183907","4500183730","4500183723","4500190204","4500190205","4500187539","4500187540","4500182457","4500161259","4500192338","4500183912","4500192236","4500183958","4500192336","4500183960","4500192328","4500192332","4500188352","4500188353","4500190181","4500190182","4500190183","4500188618","4500190878","4500182366","4500182300","4500183507","4500183338","4500183274","4500183275","4500183276","4500190452","4500183734","4500192239","4500190820","4500183543","4500183544","4500183545","4500183546","4500183547","4500183548","4500183410","4500183411","4500192984","4500192985","4500192986","4500192987","4500192977","4500192978","4500192979","4500183486","4500183487","4500183488","4500183489","4500183490","4500183373","4500183374","4500183375","4500183353","4500183354","4500183295","4500188239","4500190814","4500190815","4500193810","4500193811","4500183508","4500183509","4500183475","4500183476","4500183421","4500183277","4500183278","4500191096","4500191097","4500191098","4500191099","4500191100","4500191431","4500191432","4500191433","4500191395","4500191396","4500183227","4500183228","4500183229","4500190861","4500190862","4500187940","4500187941","4500187922","4500187908","4500187909","4500183549","4500183550","4500183551","4500183552","4500183553","4500183555","4500183556","4500183557","4500183558","4500183481","4500183482","4500183491","4500183492","4500183415","4500183416","4500183417","4500183343","4500183344","4500183357","4500183358","4500183359","4500183284","4500183285","4500183294","4500183299","4500183301","4500183216","4500183217","4500183218","4500183219","4500183224","4500183225","4500183226","4500185017","4500192006","4500194371","4500194372","4500184832","4500184834","4500184798","4500184763","4500184765","4500184766","4500184693","4500184695","4500184662","4500188377","4500183146","4500183126","4500191466","4500183106","4500191463","4500184627","4500184628","4500193015","4500187809","4500187810","4500184578","4500184579","4500191050","4500190356","4500190332","4500183058","4500191447","4500191448","4500191449","4500183011","4500191409","4500191410","4500191411","4500187736","4500188422","4500188446","4500190291","4500190257","4500190259","4500190260","4500191005","4500184154","4500184155","4500190227","4500184168","4500182520","4500182521","4500187533","4500187534","4500190077","4500182479","4500190066","4500182442","4500182443","4500187709","4500187710","4500191900","4500191901","4500188330","4500188610","4500188611","4500190860","4500190855","4500182420","4500190048","4500182398","4500190039","4500182387","4500182377","4500182347","4500182348","4500182349","4500182292","4500187625","4500187626","4500190834","4500187618","4500187609","4500187610","4500187611","4500182235","4500187501","4500190034","4500183953","4500190438","4500190439","4500190440","4500190413","4500183061","4500183014","4500191399","4500184172","4500190206","4500190184","4500190863","4500182411","4500182367","4500183279","4500183422","4500183062","4500183493","4500183496","4500183497","4500183302","4500183303","4500183304","4500191143","4500191144","4500191145","4500191146","4500191147","4500191148","4500190134","4500183510","4500183511","4500183512","4500183376","4500191434","4500191435","4500183423","4500183063","4500183064","4500183015","4500187942","4500187923","4500187910","4500183559","4500183560","4500183561","4500183483","4500183484","4500183498","4500183418","4500183419","4500183420","4500183345","4500183346","4500183286","4500183287","4500183220","4500183221","4500183222","4500183223","4500192007","4500194373","4500194374","4500187852","4500184696","4500184697","4500184663","4500187842","4500183147","4500183127","4500191467","4500183107","4500191464","4500187830","4500187831","4500193016","4500187811","4500187812","4500192988","4500192989","4500190364","4500191051","4500191923","4500191924","4500190357","4500183059","4500183012","4500187737","4500188423","4500188447","4500188448","4500190261","4500190262","4500191006","4500191007","4500190228","4500190229","4500190230","4500191912","4500182522","4500182523","4500187535","4500187536","4500190078","4500182466","4500187517","4500190061","4500187711","4500187712","4500191902","4500191903","4500188292","4500188293","4500188612","4500188613","4500190049","4500182401","4500190040","4500182382","4500187512","4500182350","4500182351","4500182352","4500187619","4500187612","4500187613","4500187614","4500182236","4500187503","4500187505","4500190442","4500190414","4500183028","4500182986","4500182987","4500190207","4500183029","4500183230","4500183231","4500183232","4500191931","4500191932","4500191933","4500191934","4500191935","4500191936","4500182988","4500182989","4500190135","4500192346","4500192347","4500183377","4500183378","4500183379","4500183380","4500183163","4500183164","4500183165","4500183166","4500183167","4500191149","4500191151","4500191152","4500191153","4500191154","4500191155","4500191280","4500191265","4500192237","4500183030","4500194395","4500192651","4500192652","4500184503","4500190443","4500190415","4500190396","4500183031","4500182990","4500182991","4500190208","4500183520","4500183521","4500183522","4500183523","4500183524","4500183381","4500183382","4500183168","4500183169","4500183170","4500183171","4500183172","4500194311","4500183081","4500183033","4500183034","4500190136","4500183525","4500183526","4500183527","4500183528","4500183529","4500183530","4500183177","4500183178","4500183181","4500183182","4500183183","4500183184","4500191070","4500191071","4500191072","4500191073","4500191074","4500191075","4500191077","4500191078","4500191079","4500191080","4500182992","4500190952","4500190953","4500190954","4500190955","4500190956","4500190957","4500190958","4500190966","4500190967","4500190888","4500190889","4500190890","4500190891","4500192324","4500190444","4500190416","4500190397","4500190398","4500183035","4500183036","4500190210","4500192344","4500192333","4500184283","4500190128","4500183531","4500183532","4500183533","4500183534","4500183185","4500183186","4500183187","4500183188","4500183189","4500183190","4500183192","4500183193","4500187621","4500190137","4500190821","4500183194","4500183195","4500183196","4500183197","4500183198","4500183199","4500183201","4500183202","4500183094","4500183082","4500183037","4500183038","4500182993","4500182994","4500188440","4500183135","4500183115","4500191274","4500192254","4500193798","4500193797","4500191101","4500191102","4500191103","4500191104","4500191913","4500191914","4500191915","4500191916","4500191917","4500191918","4500191919","4500191920","4500191921","4500191922","4500193145","4500193146","4500193134","4500193120","4500183424","4500183425","4500183426","4500183427","4500191260","4500192014","4500192015","4500192001","4500192002","4500191237","4500191227","4500193025","4500193026","4500192695","4500192681","4500192682","4500192660","4500192661","4500191206","4500193023","4500191188","4500193005","4500191105","4500191106","4500191107","4500191950","4500191056","4500191937","4500191938","4500192646","4500191416","4500191417","4500191036","4500191030","4500192971","4500190993","4500190968","4500192342","4500190947","4500191911","4500190917","4500190918","4500190843","4500190822","4500190799","4500190800","4500190786","4500192348","4500192349","4500183567","4500183568","4500183569","4500183570","4500183428","4500183233","4500183234","4500183235","4500183236","4500183237","4500183238","4500183239","4500193147","4500193135","4500193121","4500183571","4500183572","4500183573","4500183574","4500183575","4500183240","4500183241","4500183242","4500183243","4500183244","4500183245","4500191261","4500192016","4500192003","4500194389","4500193031","4500191980","4500191228","4500191215","4500193027","4500192683","4500192684","4500192662","4500192663","4500191207","4500193024","4500191190","4500193006","4500191108","4500191109","4500191110","4500191061","4500191951","4500191057","4500191939","4500191940","4500191043","4500192647","4500191037","4500192972","4500190994","4500190969","4500190948","4500190919","4500190881","4500190849","4500190844","4500190823","4500192373","4500190801","4500190802","4500190787","4500183203","4500183204","4500183205","4500183206","4500183207","4500183246","4500183247","4500183248","4500191273","4500191277","4500191281","4500191282","4500191268","4500190138","4500190812","4500193148","4500193136","4500193122","4500191262","4500192017","4500192004","4500194390","4500193032","4500191238","4500191229","4500191968","4500192696","4500192686","4500192687","4500192664","4500192665","4500191957","4500191191","4500193007","4500191272","4500191275","4500191276","4500191278","4500191279","4500191952","4500191941","4500191942","4500191943","4500192648","4500183026","4500191418","4500191038","4500191031","4500192973","4500192968","4500190970","4500191266","4500190949","4500190920","4500190883","4500190858","4500190845","4500190803","4500190804","4500190788","4500190209","4500190959","4500190960","4500190961","4500190962","4500190963","4500190964","4500184632","4500184633","4500184634","4500184635","4500184636","4500193022","4500191081","4500191082","4500191083","4500191084","4500191085","4500191086","4500191087","4500191088","4500193139","4500193140","4500193149","4500193126","4500193127","4500193128","4500193137","4500193111","4500193113","4500193115","4500193123","4500191256","4500192008","4500192009","4500191998","4500193073","4500193076","4500194384","4500194392","4500191982","4500193029","4500193033","4500191234","4500191977","4500191981","4500191231","4500191972","4500191975","4500191216","4500191962","4500191963","4500192692","4500192671","4500192672","4500192673","4500192689","4500192653","4500192654","4500192666","4500191202","4500191208","4500191954","4500193017","4500191165","4500191166","4500191193","4500192991","4500192992","4500193008","4500191089","4500191090","4500191111","4500191062","4500191944","4500191945","4500191052","4500191058","4500191925","4500191926","4500191040","4500191044","4500192976","4500192649","4500191008","4500191009","4500192974","4500190987","4500190988","4500190995","4500190941","4500190942","4500191904","4500191905","4500190926","4500190927","4500190938","4500190921","4500190870","4500190871","4500190885","4500190856","4500190846","4500190816","4500190824","4500190791","4500190792","4500190805","4500190806","4500190782","4500182249","4500192326","4500192327","4500192325","4500192487","4500192247","4500192248","4500192244","4500192245","4500192246","4500192249","4500192250","4500192252","4500192253","4500192339","4500192343","4500192238","4500192329","4500192330","4500192335","4500192322","4500192374","4500193796","4500192376","4500192377","4500193141","4500193142","4500193150","4500193129","4500193130","4500193138","4500193112","4500193116","4500193117","4500193124","4500191257","4500192010","4500192011","4500192018","4500191999","4500192005","4500193074","4500194386","4500191983","4500193030","4500193034","4500191235","4500191239","4500191978","4500191232","4500191230","4500191973","4500191964","4500191965","4500191969","4500192674","4500192675","4500192676","4500192690","4500192655","4500192656","4500192667","4500191203","4500191955","4500191958","4500193018","4500191136","4500191138","4500191139","4500191140","4500191141","4500191142","4500191156","4500191158","4500191159","4500191160","4500191161","4500191163","4500191164","4500191167","4500191168","4500191194","4500192993","4500192994","4500193009","4500191091","4500191092","4500191112","4500191946","4500191947","4500191953","4500191053","4500191059","4500191927","4500191928","4500191041","4500183080","4500183088","4500191460","4500191461","4500192650","4500183060","4500191436","4500191450","4500183013","4500191397","4500191419","4500191034","4500191039","4500184482","4500184483","4500184485","4500191026","4500191027","4500191028","4500191029","4500191032","4500191022","4500191023","4500190290","4500190292","4500190293","4500191017","4500191018","4500191010","4500191011","4500191014","4500190989","4500190990","4500190996","4500190965","4500190971","4500190943","4500190944","4500190950","4500191906","4500191907","4500190928","4500190929","4500190939","4500190905","4500190906","4500190907","4500190922","4500190872","4500190873","4500190886","4500184177","4500184178","4500184179","4500184180","4500184181","4500184182","4500184184","4500184185","4500190848","4500190850","4500182391","4500190835","4500190836","4500190847","4500190817","4500190825","4500190793","4500190794","4500190807","4500190808","4500184226","4500190789","4500182268","4500182269","4500182250","4500184190","4500193143","4500193144","4500193151","4500193131","4500193132","4500193118","4500193119","4500193125","4500191258","4500192012","4500192013","4500192000","4500193075","4500194388","4500194393","4500191984","4500191236","4500191979","4500191233","4500191974","4500191976","4500191217","4500191966","4500191967","4500192693","4500192697","4500192677","4500192678","4500192679","4500192657","4500192658","4500191204","4500191209","4500191956","4500193019","4500191169","4500191170","4500191195","4500192995","4500192996","4500193010","4500191093","4500191094","4500191063","4500191948","4500191949","4500191054","4500191929","4500191930","4500191042","4500191045","4500191035","4500191033","4500191024","4500191025","4500191019","4500191020","4500191012","4500191013","4500190991","4500190992","4500190951","4500191908","4500191909","4500190930","4500190931","4500190940","4500190908","4500190909","4500190923","4500190887","4500190851","4500190837","4500190838","4500190818","4500190826","4500190795","4500190796","4500190809","4500190810","4500190784","4500190790","4500182251","4500191185","4500191186","4500191187","4500192997","4500192998","4500192999","4500193000","4500193001","4500193002","4500193003","4500193004","4500187787","4500187788","4500187789","4500187790","4500190388","4500190389","4500190390","4500190391","4500190392","4500190393","4500190394","4500190395","4500184486","4500184487","4500184488","4500188434","4500188435","4500188436","4500188437","4500190307","4500190309","4500190310","4500190311","4500190312","4500190316","4500191021","4500182968","4500182252","4500190892","4500190893","4500190894","4500184274","4500188302","4500192321","4500192337","4500183968","4500182969","4500184248","4500184249","4500184227","4500182275","4500190879","4500190880","4500184214","4500188236","4500187627","4500188250","4500190781","4500185587","4500185587","4500185587","4500185587","4500185587","4500185587","4500184262","4500188354","4500183093","4500190910","4500190884","4500190924","4500190925","4500190895","4500190896","4500190897","4500190898","4500190899","4500190900","4500190901","4500190902","4500190903","4500190904","4500182276","4500188303","4500188304","4500190190","4500190842","4500183089","4500190932","4500190933","4500184215","4500190798","4500188238","4500190783","4500188331","4500188332","4500188355","4500190130","4500190131","4500190934","4500190935","4500190882","4500190936","4500190937","4500190911","4500190912","4500190913","4500190914","4500190915","4500190916"]
  HEADINGS = {
    order_number:'Order Number',line_number:'Line Number',article_number:'Article Number',
    article_name:'Article Name',quantity:'Ordered Quantity',price:'Unit Price',total_price:'Total Price',
    snapshot_date:'History Record Date',order_id:'Order Database ID',ship_confirmed_date:'Ship Confirmed Date',
    departed_date:'ASN Departed Date',vendor_code:'Vendor Code',vendor_name:'Vendor Name',
    entry_number:'Entry Number',release_date:'Release Date',mbol:'Master Bill',entered_value:'Entered Value',
    entered_quantity:'Entered Quantity',entered_uom:'Entered UOM'
  }

  def self.run orders
    cdefs = OpenChain::CustomHandler::LumberLiquidators::LumberCustomDefinitionHelper.prep_custom_definitions([:ord_ship_confirmation_date,:ord_asn_departed])
    CSV.open("tmp/effective_price_report_#{Time.now.to_i}.csv", "wb") do |csv|
      csv << hash_to_array(HEADINGS)
      orders.in_groups_of(200,false).each do |order_group|
        Order.where('order_number IN (?)',order_group).includes(:custom_values,:vendor).each do |o|
          make_rows(o,cdefs).each {|row| csv << row}
        end
      end
    end
  end

  def self.run_entered_orders
    run CommercialInvoiceLine.pluck(:po_number).uniq
  end

  def self.make_rows order, cdefs
    header = make_header_hash(order,cdefs)
    es = find_effective_snapshot(order,header[:departed_date])
    add_snapshot_header_fields(header,es)
    line_hashes = make_line_hashes(header,es)
    return line_hashes.collect do |lh|
      add_entry_data(lh)
      hash_to_array(lh)
    end
  end

  def self.add_entry_data h
    article_number = h[:article_number][-8..-1]
    cil = CommercialInvoiceLine.where(part_number:article_number,po_number:h[:order_number]).includes(:entry,:commercial_invoice_tariffs).last
    return unless cil
    ent = cil.entry
    cit = cil.commercial_invoice_tariffs.first
    h[:entry_number] = ent.entry_number
    h[:release_date] = ent.release_date
    h[:mbol] = ent.master_bills_of_lading
    h[:entered_value] = cit.entered_value
    h[:entered_quantity] = cit.classification_qty_1
    h[:entered_uom] = cit.classification_uom_1
  end

  def self.add_snapshot_header_fields(h,es)
    order_hash = es.snapshot_hash['entity']['model_fields']
    h[:order_number] = order_hash['ord_ord_num']
    h[:snapshot_date] = es.created_at
  end

  def self.make_header_hash order, cdefs
    h = {}
    h[:order_id] = order.id
    h[:ship_confirmed_date] = order.custom_value(cdefs[:ord_ship_confirmation_date])
    h[:departed_date] = order.custom_value(cdefs[:ord_asn_departed])
    h[:vendor_code] = order.vendor.system_code
    h[:vendor_name] = order.vendor.name
    h
  end

  def self.make_line_hashes base_hash, es
    r = []
    sh = es.snapshot_hash
    children = sh['entity']['children']
    return r unless children
    children.each do |child|
      next unless child['entity']['core_module'] == 'OrderLine'
      child_hash = child['entity']['model_fields']
      h = base_hash.clone
      h[:line_number] = child_hash['ordln_line_number']
      h[:article_number] = child_hash['ordln_puid']
      h[:article_name] = child_hash['*cf_183']
      h[:quantity] = child_hash['ordln_ordered_qty']
      h[:price] = child_hash['ordln_ppu']
      h[:total_price] = child_hash['ordln_total_cost']
      r << h
    end
    return r
  end

  def self.find_effective_snapshot order, departed_date
    # if we have departed date then we want the snapshot just before it, otherwise, use the newest
    rel = order.entity_snapshots.order('created_at DESC')
    rel = rel.where('created_at < ?',departed_date) if departed_date
    rel.first
  end

  def self.hash_to_array h
    return [:order_number,:line_number,:article_number,
      :article_name,:quantity,:price,:total_price,:snapshot_date,
      :order_id, :ship_confirmed_date, :departed_date, :vendor_code,
      :vendor_name, :entry_number, :release_date, :mbol, :entered_value,
      :entered_quantity, :entered_uom
    ].collect {|k| h[k]}
  end
end
