<% content_for :javascript do %>
$(function() {
  $("#btn_save").button().click(function() {
    checkUOMChange();
  });
  $("#btn_cancel").button().click(function() {
    window.location = '<%=url_for @product%>';
  });
});
function checkUOMChange() {
  ou = $("#original_uom").val();
  if(ou.length==0 || ou==$("#txt_uom").val()) {
    return $("#frm_prod").submit();
  } else {
    $('<div></div>')
    .html("<p>Are you sure you want to change the unit of measure?</p><p>This will change the unit of measure for <em>all</em> existing orders, shipments, inventory, etc.</p><p>If you have a new unit of measure for upcoming orders, click <a href='/products/new'>here</a> to create a new product.")
    .dialog({title:'Are you sure?',
      buttons:{"Yes":function() {$("#frm_prod").submit();},"No":function() {$(this).dialog('close');}}}
    );
  }
}
<% end %>

<% content_for :action_bar do %>
<button id='btn_save'>Save</button>
<button id='btn_cancel'>Cancel</button>
<% end %>
<%= form_for @product, :html=>{:id=>'frm_prod'} do |f| %>
<table>
<tr><td class='label_cell'><%= f.label :unique_identifier, "Unique ID" %>:</td><td><%= f.text_field :unique_identifier %></td></tr>
<tr><td class='label_cell'><%= f.label :name %>:</td><td><%= f.text_field :name %></td></tr>
<tr><td class='label_cell'><%= f.label :description %>:</td><td><%= f.text_field :description %></td></tr>
<tr><td class='label_cell'><%= f.label :unit_of_measure %>:</td><td><%= f.text_field :unit_of_measure, :id=>'txt_uom' %><input type='hidden' name='original_uom' id='original_uom' value='<%=@product.unit_of_measure%>' /></td></tr>
<tr><td class='label_cell'><%= f.label :vendor %>:</td><td><%= f.collection_select :vendor_id, Company.find_vendors.not_locked, :id, :name, options ={:prompt => "-Select a vendor"} %></td></tr>
<tr><td class='label_cell'><%= f.label :division %>:</td><td><%= f.collection_select :division_id, Division.all, :id, :name, options ={:prompt => "-Select a division"} %></td></tr>
<%=show_custom_fields @product, {:form=>true, :table=>true}%>
</table>	
<% end %>
</td>
</table>
