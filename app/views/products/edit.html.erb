<% content_for :javascript do %>
function checkUOMChange() {
  ou = $("#original_uom").val();
  if(ou.length==0 || ou==$("#txt_uom").val()) {
    return $("#frm_prod").submit();
  } else {
    $('<div></div>')
    .html("<p>Are you sure you want to change the unit of measure?</p><p>This will change the unit of measure for <em>all</em> existing orders, shipments, inventory, etc.</p><p>If you have a new unit of measure for upcoming orders, click <a href='/products/new'>here</a> to create a new product.")
    .dialog({title:'Are you sure?',
      buttons:{"Yes":function() {$("#frm_prod").submit();},"No":function() {$(this).dialog('close');}}}
    );
  }
}
$(function() {
  $("#btn_save").click(function() {
    checkUOMChange();
  });
  $("#btn_cancel").click(function() {
    window.location = '<%=url_for @product%>';
  });
  OpenChain.addClickMap('s',"Save","btn_save");
  OpenChain.addClickMap('c',"Cancel","btn_cancel");
  OpenChain.activateHotKeys();
  <% if @product.entity_type_id %>
    OpenChain.hideByEntityType($("#product_header"),'<%=@product.entity_type_id%>');
  <% end %>
  OpenChain.initClassifyPage();
});
<% end %>

<% content_for :action_bar do %>
  <button id='btn_save'>Save</button>
  <button id='btn_cancel'>Cancel</button>
<% end %>
<%= form_for @product, :html=>{:id=>'frm_prod'} do |f| %>
  <input type='hidden' name='original_uom' id='original_uom' value='<%=@product.unit_of_measure%>' />
  <div class='container'>
    <div class='row'>
      <div class='col-md-6'>
        <h3 class='text-center'>Attributes</h3>
        <% if @product.can_edit?(current_user) -%>
          <%= render :partial => 'product_edit', :locals=>{:form_obj => f}%>
        <% else -%>
          <%=render :partial => 'product_view', :locals => {:product => @product} %>
        <% end -%>
      </div>
      <div class='col-md-6'>
        <h3 class='text-center'>Classifications</h3>
        <% if @product.can_classify?(current_user) -%>
          <%= render :partial=>'classify', :locals=>{:form_obj=>f}%>
        <% else -%>
          <%=render :partial=>'show_classification'%>
        <% end -%>
      </div>
    </div>
  </div>
<%end-%>
