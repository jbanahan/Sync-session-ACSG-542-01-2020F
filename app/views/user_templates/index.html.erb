<div class="container">
  <div class="row">
    <div class="col-md-12">
      <h2 class="text-center">User Templates</h2>
    </div>
  </div>
  <div class="row" id='index-table-row'>
    <div class="col-md-12">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Name</th>
            <th>Template</th>
            <th>
              &nbsp;
            </th>
          </tr>
        </thead>
        <tbody>
          <%@user_templates.each do |ut|%>
            <tr>
              <td><%=ut.name%>
              <td>
                <button class='template-show btn btn-sm btn-secondary' data-template-id='<%=ut.id%>' title='View'><i class='fa fa-search-plus'></i></button>
                <button class='template-hide btn btn-sm btn-secondary' style='display:none;' data-template-id='<%=ut.id%>' title='Hide'><i class='fa fa-search-minus'></i></button>
<pre class='template-json' style='display:none;' data-template-id='<%=ut.id%>'>
<%=ut.template_json%>
</pre>
              </td>
              <td>
                <a href='<%=edit_user_template_path(ut)%>' class='btn btn-sm btn-secondary' role='button' title='Edit'><i class='fa fa-pencil'></i></a>
              </td>
            </tr>
          <%end%>
          <tr>
            <td colspan='4' class='text-right'>
              <button class='btn btn-success' id='new-template'><i class='fa fa-plus'></i></button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="row" id='new-template-row' style='display:none'>
    <div class="col-md-8 offset-md-2">
      <%=form_for UserTemplate.new(template_json:UserTemplate::DEFAULT_TEMPLATE_JSON), id:'create-form' do |f| %>
        <div class="card">
          <div class="card-header">Create New User Template</div>
          <div class="card-body">
            <%=f.label :name%>
            <%=f.text_field :name, class:'form-control'%>
            <%=f.label :template_json, 'JSON'%>
            <%=f.text_area :template_json, class:'form-control'%>
          </div>
          <div class="card-footer text-right">
            <button class='btn btn-secondary cancel-form'>Cancel</button>
            <%=f.submit 'Create', class:'btn btn-primary', role:'button' %>
          </div>
        </div>
      <%end%>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(document).on('click','.template-show',function(evt) {
    var tId = $(this).attr('data-template-id');
    $(this).hide();
    $('pre.template-json[data-template-id="'+tId+'"]').show();
    $('button.template-hide[data-template-id="'+tId+'"]').show();
  });
  $(document).on('click','.template-hide',function(evt) {
    var tId = $(this).attr('data-template-id');
    $(this).hide();
    $('pre.template-json[data-template-id="'+tId+'"]').hide();
    $('button.template-show[data-template-id="'+tId+'"]').show();
  });
  $(document).on('click','.cancel-form',function(evt) {
    $('#index-table-row').show();
    $('#new-template-row').hide();
  });
  $('#new-template').click(function() {
    $('#index-table-row').hide();
    $('#new-template-row').show();
  });
  $('#create-form').submit(function(evt) {
    return UserTemplate.validateForm($('#create-form'));
  });
</script>
