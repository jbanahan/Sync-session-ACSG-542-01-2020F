# To install the script for upstart purposes, run the following command:
# sudo cp chainio-job-queue.conf /etc/init/chainio-job-queue.conf
# sudo chmod 644 /etc/init/chainio-job-queue.conf
#
# This script is not intended to be run directly by the upstart process.
#
# The chainio.conf upstart script will run it if the EC2 instance it is running 
# on has a Role tag w/ a value of 'Job Queue'.
#
# This script will NOT run unless this instances is tagged with a Role of 'Job Queue'.
# 
# Should you need to start/stop this script manually:
#
# sudo start chainio-job-queue
# sudo stop chainio-job-queue

description "Start / Monitor ChainIO Job Queue"
author "Jeremy Hulford"
console log

# No start on, we actually want our own script to initiate 
# the service only AFTER it sets up the aws config values
stop on runlevel [!2345]

setuid ubuntu
chdir /home/ubuntu/chainio

respawn
respawn limit 15 5

pre-start script
  echo "$(date) - Starting chain-job-queue"
end script

exec /home/ubuntu/chainio/wwwvfitracknet/script/dj_monitor.sh quiet